---
const data = await fetch("https://mblcdev.com/api/book");
const response = await data.json();
const sortedResponse = response.sort(
  (a: Book, b: Book) =>
    new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
);
interface Book {
  data: {
    title: string;
    pubDate: string;
  };
  slug: string;
}
---

<section class="my-10 flex flex-col gap-4 z-40 bg-primary sticky">
  <div>
    <h2 class="title text-xl font-bold text-font">Quien Soy?</h2>
    <p class="subtitle mt-2 text-justify text-base hyphens-auto text-font">
      Soy Antonio Aranibar Leandro (27te), CEO y cofundador de mblcdev, una
      agencia de desarrollo de software con foco en innovación y crecimiento.
      Este portafolio muestra mi trabajo y mi visión, que combinan la estrategia
      para construir productos escalables con una mirada personal y creativa que
      también me define.
    </p>
    <div class="flex gap-2 items-center md:flex-row flex-col">
      <img
        src="/27te.png"
        alt="27te profile instagram"
        title="27te profile instagram"
        draggable="false"
        class="subtitle h-[600px] mt-5 rounded-sm shadow-md"
      />
    </div>
  </div>
  <div>
    <h2 class="title text-xl font-bold text-font">Trabajos</h2>
    <ul
      class="mt-3 text-justify text-base hyphens-auto flex flex-col gap-1 divide-y divide-font/20"
    >
      <li class="p-2 flex justify-between items-center">
        <div class="w-20">
          <span
            class="bg-green-800 subtitle text-font px-1 text-xs font-semibold align-middle inline-block rounded-sm uppercase tracking-tighter"
          >
            Agency
          </span>
        </div>
        <p class="w-full ml-4 subtitle text-font">mblcdev</p>
        <span class="inline-block subtitle text-nowrap text-font">
          10-07-2024
        </span>
      </li>
      <li class="p-2 flex justify-between items-center">
        <div class="w-20">
          <span
            class="bg-font subtitle text-primary px-1 text-xs font-semibold align-middle inline-block rounded-sm uppercase tracking-tighter"
          >
            SAAS
          </span>
        </div>
        <p class="w-full ml-4 text-font">MB Inventory</p>
        <span class="inline-block text-nowrap subtitle text-font">
          **-07-2025
        </span>
      </li>
      <li class="p-2 flex justify-between items-center">
        <div class="w-20">
          <span
            class="bg-font subtitle text-primary px-1 text-xs font-semibold align-middle inline-block rounded-sm uppercase tracking-tighter"
          >
            SAAS
          </span>
        </div>
        <p class="w-full ml-4 text-font subtitle">
          Generador de Contratos con IA
        </p>
        <span class="inline-block text-nowrap text-font subtitle">
          **-07-2025
        </span>
      </li>
      <li class="p-2 flex justify-between items-center">
        <div class="w-20">
          <span
            class="bg-blue-700 subtitle text-font px-1 text-xs font-semibold align-middle inline-block rounded-sm uppercase tracking-tighter"
          >
            Website
          </span>
        </div>
        <p class="w-full mx-4 text-font subtitle">Mad Exhibitions</p>
        <span class="inline-block text-nowrap text-font subtitle">
          12-04-2025
        </span>
      </li>
    </ul>
    <div
      class="border border-font/20 mt-4 rounded-sm h-full sm:h-80 flex flex-col sm:flex-row p-2 gap-10"
    >
      <div class="w-full h-full flex justify-center items-center">
        <img
          src="/cover.png"
          alt="subtitle cover de libro el diario del otro yo autor sombra de mblcdev.com"
          title="cover de libro el diario del otro yo autor sombra de mblcdev.com"
          class="h-60 aspect-auto drop-shadow-lg"
        />
      </div>
      <div class="flex justify-center flex-col">
        <span class="text-green-600 text-sm subtitle">En Producción</span>
        <h2 class="title font-bold text-lg uppercase tracking-wide text-font">
          El Diario del otro yo
        </h2>
        <p class="subtitle text-base font-light my-2 text-font">
          Una obra íntima y reflexiva que se adentra en los rincones ocultos de
          la mente a través de un personaje ficticio llamado Sombra.
        </p>
        <strong class="subtitle uppercase text-base text-font mt-5"
          >Capítulos Recientes</strong
        >
        <ul class="flex flex-col gap-2 mt-2">
          {
            sortedResponse.map((book: Book) => {
              const url = book.slug.split("/").pop();
              return (
                <li class="border-b border-font/20 flex justify-between">
                  <a
                    href={`https://mblcdev.com/books/${url}`}
                    target="_blank"
                    title={book.data.title}
                    rel="noopener noreferrer"
                    class="subtitle text-base text-font/90 hover:text-green-700"
                  >
                    {book.data.title}
                  </a>
                </li>
              );
            })
          }
        </ul>
      </div>
    </div>
  </div>
  <div>
    <h2 class="title text-xl font-bold text-font">Mi Vision</h2>
    <p class="subtitle mt-2 text-justify text-base hyphens-auto text-font">
      Mi objetivo no es solo crecer, sino crear un proyecto sólido y coherente
      que se imponga por calidad e identidad propia. Busco que la agencia sea
      referente sin copiar y que la narrativa conecte por autenticidad.
    </p>
  </div>
  <div>
    <h2 class="title text-xl font-bold text-font">Colabora conmigo</h2>
    <p class="subtitle mt-2 text-justify text-base hyphens-auto text-font">
      Trabajo con empresas, creativos e inversores que valoran tanto la
      estrategia como la autenticidad. Si buscas resultados concretos y un
      enfoque real, este es el lugar para empezar.
    </p>
    <div class="mt-4">
      <h3 class="title font-semibold text-lg text-font">Contact</h3>
      <div class="flex flex-col mt-1 gap-1">
        <a
          href="mailto:antonio@mblcdev.com"
          target="_blank"
          title="Correo electrónico de 27te"
          rel="noopener noreferrer"
          target="_blank"
          class="subtitle font-medium text-sm text-font/80 underline"
        >
          antonio@mblcdev.com
        </a>
        <a
          href="https://github.com/27te"
          title="27te Github"
          class="subtitle text-sm font-medium text-font/80 underline"
          target="_blank"
          rel="noopener noreferrer"
        >
          @27te-Github
        </a>
        <a
          href="https://www.linkedin.com/in/mblcdev"
          title="27te LinkdIn"
          class="subtitle text-sm font-medium text-font/80 underline"
          target="_blank"
          rel="noopener noreferrer"
        >
          @27te-LinkdIn
        </a>
        <a
          href="https://www.instagram.com/__27te__"
          title="27te Instagram"
          class="subtitle text-sm font-medium text-font/80 underline"
          target="_blank"
          rel="noopener noreferrer"
        >
          @27te-Instagram
        </a>
      </div>
    </div>
  </div>
</section>
<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  gsap.utils.toArray<HTMLElement>(".title").forEach((title, i) => {
    gsap.fromTo(
      title,
      {
        opacity: 0.001,
        y: 20,
        filter: "blur(4px)",
      },
      {
        opacity: 1,
        y: 0,
        filter: "blur(0px)",
        duration: 0.3,
        delay: i * 0.1, // retrasa cada uno un poco
        ease: "power2.out",
        scrollTrigger: {
          trigger: title,
          start: "top 90%",
          toggleActions: "play none none none",
          once: true,
        },
      }
    );
  });
  gsap.utils.toArray<HTMLElement>(".subtitle").forEach((subtitle, i) => {
    gsap.fromTo(
      subtitle,
      {
        scale: 0.8,
        opacity: 0.001,
      },
      {
        scale: 1,
        opacity: 1,
        duration: 0.2,
        delay: 0.2, // retrasa cada uno un poco
        ease: "power2.out",
        scrollTrigger: {
          trigger: subtitle,
          start: "top 90%",
          toggleActions: "play none none none",
          once: true,
        },
      }
    );
  });
</script>
